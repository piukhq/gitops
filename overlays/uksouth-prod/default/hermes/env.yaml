apiVersion: apps/v1
kind: Deployment
metadata:
  name: hermes
spec:
  template:
    spec:
      containers:
      - name: app
        env:
        - name: HERMES_BLOB_STORAGE_DSN
          valueFrom:
            secretKeyRef:
              key: connection_string
              name: azure-storage-common
        - name: HERMES_BLOB_STORAGE_CONTAINER
          value: media/hermes
        - name: HERMES_CUSTOM_DOMAIN
          value: https://api.gb.bink.com
        - name: NO_AZURE_STORAGE
          value: 'False'
        - name: HERMES_DEBUG
          value: 'False'
        - name: FACEBOOK_CLIENT_SECRET
          value: 2642c222c8b540df960df329c54b674c
        - name: ATLAS_URL
          value: http://atlas-api/audit

        # Possibly no longer need these env vars
        - name: AZURE_ACCOUNT_NAME
          value: bink
        - name: AZURE_ACCOUNT_KEY
          value: xaeP9dmuYEWf/gthvteUj2utPcIM/B4dPRPoyHAd22LEI/6l/XJhYnzu2I66rI7PEdgoyvvDKJNYcmxd9vsLhA==
        - name: AZURE_CONTAINER
          value: media/hermes
        - name: AZURE_CUSTOM_DOMAIN
          value: https://api.gb.bink.com/content/media/hermes

        - name: HERMES_DATABASE_NAME
          value: hermes
        - name: HERMES_DATABASE_USER
          valueFrom:
            secretKeyRef:
              key: admin_user
              name: azure-pg-hermes
        - name: HERMES_DATABASE_HOST
          value: 127.0.0.1
        - name: HERMES_DATABASE_PORT
          value: '5432'
        - name: ENVIRONMENT_NAME
          value: Production Environment
        - name: ENVIRONMENT_COLOR
          value: '#BD0D22'
        - name: MIDAS_URL
          value: http://midas-api
        - name: LETHE_URL
          value: https://api.gb.bink.com/password
        - name: HECATE_URL
          value: http://hecate
        - name: METIS_URL
          value: http://metis-api
        - name: HADES_URL
          value: http://hades-api
        - name: HERMES_SENTRY_DSN
          value: https://40ec46dd6a8940c4882501427e3e3a66@o503751.ingest.sentry.io/5589266
        - name: HERMES_SENTRY_ENV
          value: prod
        - name: SENTRY_SAMPLE_RATE
          value: '0.0'
        - name: USE_INFLUXDB
          value: 'False'
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              key: uri_ssl
              name: azure-redis-vnet
        - name: CELERY_BROKER_URL
          value: amqps://prod-rabbitmq.uksouth.bink.host:5671
        - name: DEFAULT_API_VERSION
          value: '1.1'
        - name: VAULT_URL
          value: http://fakicorp:8200
        - name: SPREEDLY_BASE_URL
          value: https://core.spreedly.com
        - name: APPLE_CLIENT_SECRET
          valueFrom:
            secretKeyRef:
              key: key
              name: sign-in-with-apple
        - name: SECURE_COOKIES
          value: "True"
        - name: RETRY_PERIOD
          value: "900"
        - name: OIDC_RP_REPLY_URL
          value: https://api.gb.bink.com/admin/oidc/callback/
        - name: OIDC_CLIENT_ID
          value: 71623811-c276-4e2b-9ac3-7d0537925de1
        - name: OIDC_CLIENT_SECRET
          valueFrom:
            secretKeyRef:
              key: secret
              name: hermes-aad-client-secret
        - name: SFTP_DIRECTORY
          value: '/'
        - name: NOTIFICATION_PERIOD
          value: '7200'
        - name: NOTIFICATION_ERROR_THRESHOLD
          value: '5'
        - name: NOTIFICATION_RETRY_TIMER
          value: '120'
        - name: NOTIFICATION_RUN
          value: 'False'
        - name: BARCLAYS_SFTP_FILE_SUFFIX
          value: '_BGDTUEP05427_00000001'
        - name: NOTIFICATION_RUN_TIME
          value: '10,12,14,16,18'
