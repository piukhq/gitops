---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: hermes
spec:
  template:
    spec:
      containers:
        - name: app
          env:
            - name: HERMES_BLOB_STORAGE_DSN
              valueFrom:
                secretKeyRef:
                  key: connection_string
                  name: azure-storage-common
            - name: HERMES_BLOB_STORAGE_CONTAINER
              value: media/hermes
            - name: HERMES_CUSTOM_DOMAIN
              value: https://api.staging.gb.bink.com
            - name: NO_AZURE_STORAGE
              value: 'False'
            - name: ENVIRONMENT_NAME
              value: Staging Environment
            - name: ENVIRONMENT_COLOR
              value: '#FAC40F'
            - name: MIDAS_URL
              value: http://midas-api
            - name: LETHE_URL
              value: https://api.staging.gb.bink.com/password
            - name: HADES_URL
              value: http://hades-api
            - name: METIS_URL
              value: http://metis-api
            - name: HERMES_SENTRY_DSN
              value: https://40ec46dd6a8940c4882501427e3e3a66@o503751.ingest.sentry.io/5589266
            - name: HERMES_SENTRY_ENV
              value: staging
            - name: SENTRY_SAMPLE_RATE
              value: '0.0'
            - name: HERMES_DEBUG
              value: 'false'
            - name: USE_INFLUXDB
              value: 'False'
            - name: REDIS_URL
              value: redis://redis:6379/0
            - name: CELERY_BROKER_URL
              value: pyamqp://guest:guest@rabbitmq//
            - name: DEFAULT_API_VERSION
              value: '1.1'
            - name: ATLAS_URL
              value: http://atlas-api/audit
            - name: VAULT_URL
              value: http://fakicorp:8200
            - name: APPLE_CLIENT_SECRET
              valueFrom:
                secretKeyRef:
                  key: key
                  name: sign-in-with-apple
            - name: SPREEDLY_BASE_URL
              value: http://pelops-api/spreedly
            - name: DEFAULT_API_VERSION
              value: '1.1'
            - name: SECURE_COOKIES
              value: 'True'
            - name: OIDC_RP_REPLY_URL
              value: https://api.staging.gb.bink.com/admin/oidc/callback/
            - name: OIDC_CLIENT_ID
              value: 1a5d83f3-da1f-401c-ac5f-d41c3fa0d9ef
            - name: OIDC_CLIENT_SECRET
              value: -NGSjpWWx_1w-6~.NkIl3lf~DC3Rg-.CMz
            - name: SFTP_DIRECTORY
              value: uploads
            - name: NOTIFICATION_PERIOD
              value: '3600'
            - name: NOTIFICATION_ERROR_THRESHOLD
              value: '3'
            - name: NOTIFICATION_RETRY_TIMER
              value: '120'
            - name: NOTIFICATION_RUN
              value: 'True'
            - name: RABBIT_DSN
              value: amqp://guest:guest@rabbitmq:5672/
            - name: BARCLAYS_SFTP_FILE_SUFFIX
              value: _DTUIL05787
            - name: NOTIFICATION_RUN_TIME
              value: 10,11,12,13,14,15,16
            - name: HERMES_DATABASE_URL
              valueFrom:
                secretKeyRef:
                  name: azure-pgfs
                  key: common_hermes
