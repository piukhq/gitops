apiVersion: apps/v1
kind: Deployment
metadata:
  name: pyqa
spec:
  template:
    spec:
      containers:
      - name: app
        env:
        - name: FRIENDLY_NAME
          value: Staging - Barclays
        - name: BLOB_STORAGE_DSN
          valueFrom:
            secretKeyRef:
              key: connection_string
              name: azure-storage-common
        - name: TEAMS_WEBHOOK
          value: https://hellobink.webhook.office.com/webhookb2/bf220ac8-d509-474f-a568-148982784d19@a6e2367a-92ea-4e5a-b565-723830bcc095/IncomingWebhook/0856493823a1484b9adfa37c942d2da4/48aca6b1-4d56-4a15-bc92-8aa9d97300df
        - name: SCHEDULE
          value: 5 22 * * *
        - name: COMMAND
          value: pytest --html report.html --self-contained-html -s -m sanity
            --channel barclays --env staging
        - name: ALERT_ON_SUCCESS
          value: "True"
        - name: ALERT_ON_FAILURE
          value: "True"
        - name: VAULT_URL
          value: https://bink-uksouth-staging-com.vault.azure.net/
        - name: HERMES_DATABASE_URI
          valueFrom:
            secretKeyRef:
              name: azure-pgfs
              key: common_hermes
        - name: HARMONIA_DATABASE_URI
          valueFrom:
            secretKeyRef:
              name: azure-pgfs
              key: common_harmonia
