---
bases:
  - ../base

nameSuffix: -apiv2

images:
  - name: binkcore.azurecr.io/pyqa
    newName: binkcore.azurecr.io/bink-api-v2-automation-suite:latest

patches:
  - target:
      kind: CronJob
    patch: |-
      - op: add
        path: /spec/jobTemplate/spec/template/spec/containers/1/args
        value: [ "bash", "-c", "pytest --html report.html --self-contained-html -m bink_regression_api2 --channel bink --env staging && echo $? > /tmp/status.txt || true" ]
  - target:
      kind: CronJob
    patch: |-
      - op: replace
        path: /spec/jobTemplate/spec/template/metadata/labels/org
        value: apiv2
  - target:
      kind: CronJob
    patch: |-
      - op: replace
        path: /spec/schedule
        value: 0 0 * * *
