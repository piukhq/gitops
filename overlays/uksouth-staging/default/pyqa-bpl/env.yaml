---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: pyqa-bpl
spec:
  template:
    spec:
      containers:
        - name: app
          env:
            - name: ALERT_ON_SUCCESS
              value: 'True'
            - name: ALERT_ON_FAILURE
              value: 'True'
            - name: BLOB_STORAGE_DSN
              valueFrom:
                secretKeyRef:
                  key: connection_string
                  name: azure-storage-common
            - name: COMMAND
              value: pytest -m bpl
            - name: POLARIS_ENV_BASE_URL
              value: https://bpl.staging.gb.bink.com/bpl/loyalty
            - name: VELA_ENV_BASE_URL
              value: https://bpl.staging.gb.bink.com/bpl/retailers
            - name: CARINA_ENV_BASE_URL
              value: https://bpl.staging.gb.bink.com/bpl/rewards
            - name: MOCK_SERVICE_BASE_URL
              value: http://luna-api
            - name: REDIS_URL
              value: redis://redis:6379/0
            - name: REPORT_CONTAINER
              value: qareports
            - name: REPORT_DIRECTORY
              value: bpl/isolated/
            - name: SCHEDULE
              value: 00 22 * * *
            - name: BLOB_IMPORT_CONTAINER
              value: carina-imports
            - name: BLOB_ARCHIVE_CONTAINER
              value: carina-archive
            - name: POLARIS_DATABASE_URI
              valueFrom:
                secretKeyRef:
                  name: azure-pgfs
                  key: common_polaris
            - name: VELA_DATABASE_URI
              valueFrom:
                secretKeyRef:
                  name: azure-pgfs
                  key: common_vela
            - name: CARINA_DATABASE_URI
              valueFrom:
                secretKeyRef:
                  name: azure-pgfs
                  key: common_carina
            - name: TEAMS_WEBHOOK
              value: https://hellobink.webhook.office.com/webhookb2/bf220ac8-d509-474f-a568-148982784d19@a6e2367a-92ea-4e5a-b565-723830bcc095/IncomingWebhook/0856493823a1484b9adfa37c942d2da4/48aca6b1-4d56-4a15-bc92-8aa9d97300df
            - name: VAULT_URL
              value: https://bink-uksouth-staging-com.vault.azure.net/
