apiVersion: apps/v1
kind: Deployment
metadata:
  name: harmonia
spec:
  template:
    spec:
      containers:
      - name: app
        env:
        - name: TXM_BLOB_STORAGE_DSN
          valueFrom:
            secretKeyRef:
              key: connection_string
              name: azure-storage-common
        - name: TXM_REDIS_URL
          value: redis://redis:6379/0
        - name: TXM_POSTGRES_URI
          valueFrom:
            secretKeyRef:
              name: azure-pgfs-common
              key: common_harmonia
        - name: TXM_HERMES_URL
          value: http://hermes-api
        - name: TXM_EUROPA_URL
          value: http://europa-api/config_service
        - name: TXM_ATLAS_URL
          value: http://atlas-api/audit
        - name: TXM_HERMES_SLUG_FORMAT_STRING
          value: '{}-mock'
        - name: TXM_SENTRY_DSN
          value: https://39134637f8aa4bd190c23db0b23f6413@o503751.ingest.sentry.io/5609964
        - name: TXM_SENTRY_ENV
          value: dev
        - name: TXM_RABBITMQ_HOST
          value: rabbitmq
        - name: TXM_RABBITMQ_PORT
          value: "5672"
        - name: TXM_RABBITMQ_USER
          value: guest
        - name: TXM_RABBITMQ_PASS
          value: guest
        - name: TXM_VAULT_URL
          value: https://bink-uksouth-dev-com.vault.azure.net/
        - name: TXM_SIMULATE_EXPORTS
          value: 'true'
        - name: TXM_AAD_TENANT_ID
          value: a6e2367a-92ea-4e5a-b565-723830bcc095
        - name: TXM_HERMES_SLUGS_TO_FORMAT
          value: harvey-nichols,iceland-bonus-card,cooperative
        - name: TXM_TRACING_AGENT_HOST
          valueFrom:
            fieldRef:
              fieldPath: status.hostIP
        - name: TXM_TRACING_SAMPLE_RATE
          value: "1"

